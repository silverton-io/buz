<html>
    <head>
        <script>
            ;(function(p,l,o,w,i,n,g){if(!p[i]){p.GlobalSnowplowNamespace=p.GlobalSnowplowNamespace||[]; p.GlobalSnowplowNamespace.push(i);p[i]=function(){(p[i].q=p[i].q||[]).push(arguments) };p[i].q=p[i].q||[];n=l.createElement(o);g=l.getElementsByTagName(o)[0];n.async=1; n.src=w;g.parentNode.insertBefore(n,g)}}(window,document,"script","https://cdn.jsdelivr.net/npm/@snowplow/javascript-tracker@3.2.3/dist/sp.js","snowplow")); 
        </script>
    </head>
    <script>
        window.snowplow('newTracker', 'sp', 'localhost:8080', {
            appId: 'site',
            // eventMethod: 'get',
            eventMethod: 'post',
            bufferSize: 2, // Buffer post before sending
            cookieName: "sp-nuid",
            cookieSameSite: 'Lax',
            forceSecureTracker: false,
            withCredentials: false,
        })


        window.snowplow('addPlugin', "https://cdn.jsdelivr.net/npm/@snowplow/browser-plugin-link-click-tracking@latest/dist/index.umd.min.js",["snowplowLinkClickTracking", "LinkClickTrackingPlugin"]);
        window.snowplow('addPlugin', "https://cdn.jsdelivr.net/npm/@snowplow/browser-plugin-ecommerce@latest/dist/index.umd.min.js",["snowplowEcommerce", "EcommercePlugin"]);

        window.snowplow('enableActivityTracking', {
            minimumVisitLength: 10,
            heartbeatDelay: 10
        });
        window.snowplow('trackPageView');
        window.snowplow('setUserId', 'jake@bostata.com');
        window.snowplow('enableFormTracking');
    </script>
    <body>
        <h1>Tracker Test</h1>
        <button style="margin-top: 2em; margin-bottom: 2em" id="self-describing">Press Me For Self Describing Event</button><br>
        <button style="margin-top: 2em; margin-bottom: 2em" id="struct">Press Me For Struct Event</button><br>
        <button style="margin-top: 2em; margin-bottom: 2em" id="transaction">Press Me For Transaction Event With One Item</button><br>
        <a href="http://localhost:8080/r/tp2?u=http://facebook.com" target="_blank">Redirect to Facebook but Include Tracking</a><br>
        <div style="margin-top: 2em; margin-bottom: 2em"></div>
        <form>
            <label for="fname">First name:</label><br>
            <input type="text" id="fname" name="fname"><br>
            <label for="lname">Last name:</label><br>
            <input type="text" id="lname" name="lname">
            <input type="submit" value="Submit">
        </form>
    </body>
    <footer>
        <script>
            document.getElementById('self-describing').addEventListener("click", function() {
                window.snowplow('trackSelfDescribingEvent', {
                    event: {
                        schema: "com.sixriver/ui/clicked-button/1-0-0",
                        data: {
                            buttonId: "self-describing",
                            value: "now"
                        }
                    }
                })
            });

            document.getElementById('struct').addEventListener("click", function() {
                window.snowplow('trackStructEvent', {
                    category: "ui",
                    action: "clicked-button",
                    label: "struct-event",
                    property: "someprop",
                    value: 10.0
                })
            });

            document.getElementById('transaction').addEventListener("click", function() {
                window.snowplow('addTrans', {
                    orderId: '1234',  // required
                    total: 11.99,   // required
                    affiliation: 'Acme Clothing', 
                    tax: 1.29,
                    shipping: 5,
                    city: 'San Jose',
                    state: 'California',
                    country: 'USA',
                    currency: 'USD'
                })
                window.snowplow('addItem', {
                    orderId: '1234', // required
                    sku: 'DD44',     // required
                    name: 'T-Shirt',      
                    category: 'Green Medium',
                    price: 11.99,
                    quantity: 1,
                    currency: 'USD'
                });
                window.snowplow('trackTrans');
            });

        </script>
    </footer>
</html>